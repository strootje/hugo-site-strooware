---

type: docker
kind: pipeline
name: default

steps:
  # - name: submodules
  #   image: alpine/git
  #   commands:
  #     - git submodule update --init --recursive

  - name: build
    image: plugins/hugo
    settings:
      hugo_version: 0.92.0
      extended: true
      validate: true

  - name: deploy
    image: appleboy/drone-scp
    settings:
      host: 10.0.0.138
      user:
        from_secret: deploy_user
      key:
        from_secret: deploy_ssh_key
      target: /opt/pilab/services/gohugo/strooware.xyz/content/
      strip_components: 1
      source: ./public/*
      overwrite: true
